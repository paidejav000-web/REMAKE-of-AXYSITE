<script type="module">
  // GitHub Pagesâ€“safe PolyTrack loader
  // Files MUST be same-origin:
  // main.bundle.js
  // simulation_worker.bundle.js

  const originalWorker = window.Worker;

  window.Worker = function (scriptURL, options) {
    if (typeof scriptURL === "string" &&
        scriptURL.includes("simulation_worker.bundle.js")) {
      scriptURL = "./simulation_worker.bundle.js";
    }
    return new originalWorker(scriptURL, options);
  };

  window.Worker.prototype = originalWorker.prototype;

  // Load PolyTrack normally
  import "./main.bundle.js";
</script>
